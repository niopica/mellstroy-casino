import { useState, useEffect, useRef } from 'react';

export const useStream = () => {
  // –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —á–∞—Ç–∞
  const [chatMessages, setChatMessages] = useState<any[]>([]);
  const [chatInput, setChatInput] = useState('');
  const [chatInputMobile, setChatInputMobile] = useState('');

  // –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –¥–æ–Ω–∞—Ç–æ–≤
  const [recentDonations, setRecentDonations] = useState<any[]>([]);

  const chatMessagesRef = useRef<HTMLDivElement>(null);
  const chatMessagesMobileRef = useRef<HTMLDivElement>(null);

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞
  useEffect(() => {
    addWelcomeMessage();
    startChat();
    startRecentDonations();
  }, []);

  // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª —á–∞—Ç–∞
  useEffect(() => {
    if (chatMessagesRef.current) {
      chatMessagesRef.current.scrollTop = chatMessagesRef.current.scrollHeight;
    }
    if (chatMessagesMobileRef.current) {
      chatMessagesMobileRef.current.scrollTop = chatMessagesMobileRef.current.scrollHeight;
    }
  }, [chatMessages]);

  // –ß–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏
  const addWelcomeMessage = () => {
    const welcomeMessages = [
      { username: 'Mellstroy', message: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å—Ç—Ä–∏–º! üéÆ', type: 'moderator' },
      { username: 'Moderator', message: '–ß–∞—Ç –æ—Ç–∫—Ä—ã—Ç! –ü–∏—à–∏—Ç–µ —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è üí¨', type: 'moderator' },
      { username: 'viewer123', message: '–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º! üéâ', type: 'user' },
      { username: 'mell_fan', message: '–õ—É—á—à–∏–π —Å—Ç—Ä–∏–º–µ—Ä! üî•', type: 'user' },
      { username: 'casino_lover', message: '–ö–æ–≥–¥–∞ –∏–≥—Ä–∞–µ–º? üé∞', type: 'user' },
    ];

    welcomeMessages.forEach((msg, index) => {
      setTimeout(() => {
        addChatMessage(msg.type, msg.username, msg.message, false);
      }, index * 1000);
    });
  };

  const startChat = () => {
    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è - –±–æ–ª–µ–µ —á–∞—Å—Ç–æ –¥–ª—è –∂–∏–≤–æ–≥–æ —á–∞—Ç–∞
    setInterval(() => {
      addRandomChatMessage();
    }, 800 + Math.random() * 1200); // –ë—ã—Å—Ç—Ä–µ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

    // –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π
    setInterval(() => {
      addModeratorMessage();
    }, 15000 + Math.random() * 10000);

    setInterval(() => {
      addSubscriberMessage();
    }, 20000 + Math.random() * 15000);

    setInterval(() => {
      addBotMessage();
    }, 25000 + Math.random() * 20000);

    // –°–ª—É—á–∞–π–Ω—ã–µ –≤—Å–ø–ª–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    setInterval(() => {
      createChatSpam();
    }, 60000 + Math.random() * 120000);

    // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
    setInterval(() => {
      addSpecialEvent();
    }, 120000 + Math.random() * 180000);
  };

  const addRandomChatMessage = () => {
    const usernames = [
      'burmalda228',
      'sup4ik',
      'batyaLIVE',
      'mellfan2000',
      'chechevicaTOP',
      'realFlexer',
      'melcontent',
      'prostoVasya',
      'ded_memories',
      'casino_guru',
      'bormotun',
      'FlexBoy',
      'krutoy_donater',
      'OldMelViewer',
      'd0nat_men',
      'f1xstream',
      'batyazin',
      'chelik_iz_chata',
      'stream_pahan',
      'ZalupnyVibe',
      'kasinochik',
      'flexy_mode',
      'burmaldovich',
      'chat_molodoy',
      'realKorish',
      'batyaTop1',
      'xX_Mel_Xx',
      'melarmy2024',
      'contentMaker',
      'dedpoolForever',
      'kto_zdes_s_2020',
      'vse_po_klassike',
      'melcasinoVIP',
      'donat_za_mel',
      'chelik228',
      'flex_dvizh',
      'batin_kotelok',
      'mel_streamer',
      'burmaldafan',
      '4echevichnyy',
      'chatvpotoke',
      'melchik',
      'kasino_master',
      'ded_smotrit',
      'livecontenter',
      'pa—Üan_s_dviza',
      'megaFlexer',
      'burmaldachampion',
      'batya_v_efire',
      'donatNaMela',
      'ProFlexer',
      'MelFanForever',
      'burmaldagod',
      'chechevichka',
      'batin_dvizh',
      'KORISH228',
      'melstroymode',
      'stream_hard',
      'vot_eto_flex',
      'chelik_s_donatom',
      'burmalda_kazino',
      'oldviewr',
      'flexxmen',
      'melllegend',
      'random_chatman',
      'batya_ne_spit',
      'mel_ded_team',
      'burmaldalive',
      'f1nalboss',
      'kasino_zdes',
      'donat_letit',
      'chatovik',
      'prostoFlex',
      'Mel_Online',
      'chechik',
      'kasino777',
      'batya_flexit',
      'MelFanReal',
      'burmaldavibes',
      'legend_chat',
      'streamy_bro',
      'dedpool_mem',
      'donatik_na_udel',
      'Melchik_live',
      'pa—Üan_na_minimalkah',
      'top_flexer',
      'burmalda_xxx',
      'batya_na_podryve',
      'stream_raznos',
      'melbrother',
      'chelik_po_dvizhu',
      'kasino_ded',
      'donatka_letit',
      'veter_burmaldy',
      'Melman',
      'ProContenter',
      'chatnostalgia',
      'burmaldist',
      'melstream_vibes',
    ];

    const messages = [
      '—á–µ –∑–∞ –¥–≤–∏–∂ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è üòÇ',
      '–±–∞—Ç—è –≤–µ—Ä–Ω—É–ª—Å—è –≤ —ç—Ñ–∏—Ä üí™',
      '–æ–ø—è—Ç—å –±—É—Ä–º–∞–ª–¥–∞ –ø–æ—à–ª–∞ üò≠',
      '–Ω—É –≤—Å—ë, –ø–æ—à—ë–ª –∫–æ–Ω—Ç–µ–Ω—Ç üí•',
      '–∑–∞–ª—É–ø–Ω—ã–π –≤–∞–π–± –ø–æ—à—ë–ª üî•',
      '–∫—Ç–æ —Å 2020 —Ç—É—Ç? üôã‚Äç‚ôÇÔ∏è',
      '–∑–≤—É–∫ –Ω–æ—Ä–º? üéß',
      '–∞ –≥–¥–µ –±–∞—Ç—è?',
      '–¥–µ–¥ –±—ã –≥–æ—Ä–¥–∏–ª—Å—è üôè',
      '–∫–æ–≥–¥–∞ –∫–∞–∑–∏–Ω–æ –æ—Ç–∫—Ä–æ—é—Ç?',
      '–≤—Å—ë, –ø–æ—à—ë–ª –¥–æ–Ω–∞—Ç üí∏',
      '–æ–ø—è—Ç—å —ç—Ç–æ—Ç —Ç—Ä–µ–∫ üò≠',
      '—á–µ—á–µ–≤–∏—Ü–∞ –ø–æ–¥—ä–µ—Ö–∞–ª–∞ üç≤',
      '–≤–æ—Ç —ç—Ç–æ —ç–Ω–µ—Ä–≥–∏—è!',
      '—Ç—É—Ç —á–∏—Å—Ç–æ —Ñ–ª–µ–∫—Å –∏–¥—ë—Ç üï∫',
      '–∫–∞–º–æ–Ω –º–µ–ª, —à–æ —Ç–≤–æ—Ä–∏—à—å üòÇ',
      '—á–∞—Ç –∂–∏–≤–æ–π, —è –≤–∏–∂—É üî•',
      '–±–∞—Ö–Ω–∏ –º—É–∑—ã–∫—É –ø–æ–≥—Ä–æ–º—á–µ üîä',
      '–∞ –≥–¥–µ –±—É—Ä–º–∞–ª–¥–∞?',
      '–±–∞—Ç—è —Å–µ–π—á–∞—Å –±—ã –æ—Ü–µ–Ω–∏–ª üë¥',
      '—Ä–µ–∞–ª—å–Ω–æ –ª–µ–≥–µ–Ω–¥–∞ –≤ –¥–µ–ª–µ',
      '–º–∏–Ω—É—Å –∫–æ–ª–æ–Ω–∫–∏ üíÄ',
      '–Ω–µ—É–∂–µ–ª–∏ –æ–ø—è—Ç—å –¥–æ–Ω–∞—Ç –±–∞—Ç—è?',
      '–∏–≥—Ä–∞–µ–º –ø–æ –∫—Ä—É–ø–Ω–æ–º—É üé∞',
      '—á–µ–ª —Ä–µ–∞–ª—å–Ω–æ –∂–∏–≤—ë—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º üòÇ',
      '—Å—Ç—Ä–∏–º –ø–æ—à—ë–ª –ø–æ –ø–ª–∞–Ω—É üì°',
      '–æ–ø—è—Ç—å –ø–æ—à–ª–∏ –¥–æ–Ω–∞—Ç—ã üíµ',
      '–≤–∏–∂—É —Å—Ç–∞—Ä—É—é –≥–≤–∞—Ä–¥–∏—é üí™',
      '—É –∫–æ–≥–æ –ª–∞–≥–∏?',
      '–∫–∞–∫–æ–π —Ç—Ä–µ–∫ –∏–≥—Ä–∞–µ—Ç?',
      '–±–∞—Ç—è –Ω–∞ –∫—É—Ö–Ω–µ, –Ω–æ –æ–¥–æ–±—Ä—è–µ—Ç üòé',
      '—á–∏—Å—Ç–æ —ç–Ω–µ—Ä–≥–∏—è –∫–∞–∫ –≤ —Å—Ç–∞—Ä—ã–µ –≤—Ä–µ–º–µ–Ω–∞ ‚ö°',
      '–∫–æ—Ä–µ—à –Ω–∞–≤—Å–µ–≥–¥–∞ —Å –Ω–∞–º–∏ ‚ù§Ô∏è',
      '–∞ –±—É–¥–µ—Ç —á–µ–ª–ª–µ–Ω–¥–∂?',
      '—á–∞—Ç, –ø–ª—é—Å –∫—Ç–æ —Ç—É—Ç —Å –Ω–∞—á–∞–ª–∞ üí¨',
      '–æ–ø—è—Ç—å –ø–æ—à—ë–ª —Ñ–ª–µ–∫—Å ü§£',
      '–º–µ–ª—Å—Ç—Ä–æ–π –≤ —É–¥–∞—Ä–µ!',
      '—ç—Ç–æ —É–∂–µ –Ω–µ —Å—Ç—Ä–∏–º, —ç—Ç–æ –∫–æ–Ω—Ü–µ—Ä—Ç üé§',
      '–æ–Ω –æ–ø—è—Ç—å –ø–æ—à—ë–ª –≤–∞-–±–∞–Ω–∫ üò≥',
      '–±—Ä–æ, –Ω–µ –ø—Ä–æ–∏–≥—Ä–∞–π –≤—Å—ë üòÇ',
      '–¥—É—à–µ–≤–Ω–æ –ø–æ—à–ª–æ ‚ù§Ô∏è',
      '—Ä–µ–∞–ª—å–Ω–æ –±–µ–∑ —Å—Ü–µ–Ω–∞—Ä–∏—è üí•',
      '–º–∏–Ω—É—Å –≥–æ–ª–æ—Å –∑–∞–≤—Ç—Ä–∞ üò≠',
      '—á–∞—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ–æ–±—â–µ?',
      '–æ–ø—è—Ç—å –æ–Ω –¥–æ–Ω–∞—Ç–∏—Ç —Å–∞–º —Å–µ–±–µ? üíÄ',
      '–∞ –±–∞—Ç—è –∑–Ω–∞–µ—Ç? üòÇ',
      '—Å—Ç–∞—Ä—ã–π –≤–∞–π–±, –∫–∞–π—Ñ!',
      '—á–µ—á–µ–≤–∏—Ü–∞ —Ä—É–ª–∏—Ç üç≤',
      '–∫–æ–Ω—Ç–µ–Ω—Ç –º–æ—â–Ω—ã–π, –±–∞–∑–∞—Ä –Ω–æ–ª—å üíØ',
      '—ç—Ö, –±—ã–ª –±—ã –¥–µ–¥, –æ—Ü–µ–Ω–∏–ª –±—ã üïäÔ∏è',
      '—Ä–µ–∞–ª—å–Ω–æ –¥–≤–∏–∂ –ø–æ—à—ë–ª üöÄ',
      '–≤—Å—ë –ø–æ –∫–ª–∞—Å—Å–∏–∫–µ üí™',
      '–∑–∞–∫–∏–Ω—É–ª–∏ –¥–æ–Ω–∞—Ç, –ø–æ–µ—Ö–∞–ª–∏ üî•',
      '–Ω—É –≤—Å—ë, –ø–æ—à—ë–ª —Ç–∞–Ω–µ—Ü üòÇ',
      '–∫—Ç–æ –ø–æ–º–Ω–∏—Ç —á–µ–ª–ª–µ–Ω–¥–∂–∏?',
      '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ, –∫–∞–∫ –≤—Å–µ–≥–¥–∞ üëë',
      '—á–∞—Ç, –Ω–µ —Å–ø–∏–º!',
      '—Å–Ω–æ–≤–∞ –ø–æ—à—ë–ª —Ñ–ª–µ–∫—Å –æ—Ç –¥—É—à–∏ üíÉ',
      '–≤–æ—Ç –∑–∞ —ç—Ç–æ —è –ª—é–±–ª—é —Å—Ç—Ä–∏–º üí•',
      '–±–∞—Ç—è –æ–¥–æ–±—Ä—è–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç ‚úÖ',
      '—á–∏—Å—Ç–æ –ø–∞—Ü–∞–Ω—Å–∫–∏–π –¥–≤–∏–∂ ü§ù',
      '—Ä–µ–∞–ª—å–Ω–æ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ üî•',
    ];

    const username = usernames[Math.floor(Math.random() * usernames.length)];
    const message = messages[Math.floor(Math.random() * messages.length)];

    addChatMessage('user', username, message, false);
  };

  const addModeratorMessage = () => {
    const moderators = ['Moderator_Pro', 'Chat_Guard', 'Stream_Mod', 'Casino_Mod', 'Mell_Mod'];
    const messages = [
      '–°–æ–±–ª—é–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —á–∞—Ç–∞! üìã',
      '–ù–µ —Å–ø–∞–º—å—Ç–µ! üö´',
      '–£–≤–∞–∂–∞–π—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞! ü§ù',
      '–î–æ–Ω–∞—Ç—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! üí∞',
      '–ö–∞–∑–∏–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ –¥–ª—è –≤—Å–µ—Ö! üé∞',
      '–°—Ç—Ä–∏–º –∏–¥—ë—Ç –æ—Ç–ª–∏—á–Ω–æ! üî•',
      '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üöÄ',
      '–ú–µ–ª—Å—Ç—Ä–æ–π –ª–µ–≥–µ–Ω–¥–∞! üëë',
      '–ß–∞—Ç –∞–∫—Ç–∏–≤–µ–Ω! üí¨',
      '–°–ø–∞—Å–∏–±–æ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å! üôè',
    ];

    const username = moderators[Math.floor(Math.random() * moderators.length)];
    const message = messages[Math.floor(Math.random() * messages.length)];

    addChatMessage('moderator', username, message, false);
  };

  const addSubscriberMessage = () => {
    const subscribers = ['VIP_Subscriber', 'Gold_Member', 'Platinum_Sub', 'Diamond_Sub', 'Legend_Sub'];
    const messages = [
      '–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–ø–∏—Å–∫—É! üíé',
      'VIP —Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! üëë',
      '–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç! ‚≠ê',
      '–ü–æ–¥–ø–∏—Å–∫–∞ —Ç–æ–ø! üî•',
      'VIP –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏! üíé',
      '–ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞—Ç—É—Å! ü•á',
      '–ü–ª–∞—Ç–∏–Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å! ü•à',
      '–ê–ª–º–∞–∑–Ω—ã–π –ø–æ–¥–ø–∏—Å—á–∏–∫! üí†',
      '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞! üåü',
      '–ü—Ä–µ–º–∏—É–º –∫–æ–Ω—Ç–µ–Ω—Ç! ‚ú®',
    ];

    const username = subscribers[Math.floor(Math.random() * subscribers.length)];
    const message = messages[Math.floor(Math.random() * messages.length)];

    addChatMessage('subscriber', username, message, false);
  };

  const addBotMessage = () => {
    const bots = ['Casino_Bot', 'Stream_Bot', 'Donation_Bot', 'Game_Bot', 'Chat_Bot'];
    const messages = [
      '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–∞–∑–∏–Ω–æ! üé∞',
      '–ò–≥—Ä—ã –∂–¥—É—Ç –≤–∞—Å! üéÆ',
      '–î–æ–Ω–∞—Ç—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è! üí∞',
      '–°—Ç—Ä–∏–º –∞–∫—Ç–∏–≤–µ–Ω! üì∫',
      '–ö–∞–∑–∏–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ 24/7! üåô',
      '–ò–≥—Ä–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ! ‚öñÔ∏è',
      '–£–¥–∞—á–∏ –≤ –∏–≥—Ä–∞—Ö! üçÄ',
      '–í—ã–∏–≥—Ä—ã–≤–∞–π—Ç–µ –±–æ–ª—å—à–µ! üèÜ',
      '–ö–∞–∑–∏–Ω–æ —Ä—É–ª–∏—Ç! üé≤',
      '–ò–≥—Ä—ã –∂–¥—É—Ç! üéØ',
    ];

    const username = bots[Math.floor(Math.random() * bots.length)];
    const message = messages[Math.floor(Math.random() * messages.length)];

    addChatMessage('bot', username, message, false);
  };

  const createChatSpam = () => {
    const spamMessages = [
      'POGGERS! ü§Ø',
      'LUL üòÇ',
      'KEKW üòÜ',
      'OMEGALUL ü§£',
      '5Head üß†',
      'EZ Clap üëè',
      'POG üòÆ',
      'MONKAS üò∞',
      'Pepega ü§™',
      'FeelsGoodMan üòä',
      'Kappa üòè',
      '4Head ü§î',
      'DansGame üò§',
      'BibleThump üò¢',
      'EleGiggle üòÑ',
      'üî•üî•üî•',
      'üíØüíØüíØ',
      'üöÄüöÄüöÄ',
      '‚≠ê‚≠ê‚≠ê',
      'üëëüëëüëë',
    ];

    const spamUsers = ['SpamBot', 'ChatSpammer', 'PogChamp', 'LULUser', 'KappaFan'];

    const spamCount = 5 + Math.floor(Math.random() * 6);
    for (let i = 0; i < spamCount; i++) {
      setTimeout(() => {
        const username = spamUsers[Math.floor(Math.random() * spamUsers.length)];
        const message = spamMessages[Math.floor(Math.random() * spamMessages.length)];
        addChatMessage('user', username, message, false);
      }, i * 200);
    }
  };

  const addSpecialEvent = () => {
    const events = [
      {
        type: 'moderator',
        username: 'System_Alert',
        message: 'üéâ –°–ü–ï–¶–ò–ê–õ–¨–ù–û–ï –°–û–ë–´–¢–ò–ï! –î–≤–æ–π–Ω—ã–µ –¥–æ–Ω–∞—Ç—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç! üí∞üí∞',
      },
      {
        type: 'subscriber',
        username: 'VIP_Announcement',
        message: 'üëë VIP –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∏–≥—Ä–∞–º! üé∞',
      },
      { type: 'bot', username: 'Casino_System', message: 'üé≤ –î–ñ–ï–ö–ü–û–¢! –ö—Ç–æ-—Ç–æ –≤—ã–∏–≥—Ä–∞–ª 1,000,000‚ÇΩ –≤ —Ä—É–ª–µ—Ç–∫–µ! üèÜ' },
      { type: 'moderator', username: 'Stream_Alert', message: 'üì∫ –ú–µ–ª—Å—Ç—Ä–æ–π –æ–±—ä—è–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π —á–µ–ª–ª–µ–Ω–¥–∂! –ö—Ç–æ –≥–æ—Ç–æ–≤? üöÄ' },
      {
        type: 'subscriber',
        username: 'Donation_Bot',
        message: 'üí∞ –†–µ–∫–æ—Ä–¥–Ω—ã–π –¥–æ–Ω–∞—Ç! 50,000‚ÇΩ –æ—Ç –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –∑—Ä–∏—Ç–µ–ª—è! üíé',
      },
    ];

    const event = events[Math.floor(Math.random() * events.length)];
    addChatMessage(event.type, event.username, event.message, false);

    setTimeout(() => {
      addChatMessage('user', 'Excited_Viewer', 'WOW! ü§Ø', false);
    }, 1000);

    setTimeout(() => {
      addChatMessage('user', 'Lucky_Player', 'INSANE! üî•', false);
    }, 2000);
  };

  const addChatMessage = (type: string, username: string, text: string, isUser: boolean = false) => {
    const timestamp = new Date().toLocaleTimeString('ru-RU', {
      hour: '2-digit',
      minute: '2-digit',
    });

    const message = {
      id: Date.now() + Math.random(),
      type,
      username,
      text,
      timestamp,
      isUser,
      highlight: type === 'moderator' || type === 'subscriber',
    };

    setChatMessages((prev) => {
      const newMessages = [...prev, message];
      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π
      return newMessages.length > 150 ? newMessages.slice(-150) : newMessages;
    });
  };

  const sendChatMessage = (chatType: 'desktop' | 'mobile' = 'desktop') => {
    const message = chatType === 'desktop' ? chatInput : chatInputMobile;
    if (!message.trim()) return;

    addChatMessage('user', '–í—ã', message, true);

    if (chatType === 'desktop') {
      setChatInput('');
    } else {
      setChatInputMobile('');
    }

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
    setTimeout(() => {
      generateBotResponse(message);
    }, 1000 + Math.random() * 2000);
  };

  const generateBotResponse = (userMessage: string) => {
    const responses = getBotResponses(userMessage);
    const response = responses[Math.floor(Math.random() * responses.length)];
    addChatMessage('bot', 'Mellstroy', response, false);
  };

  const getBotResponses = (userMessage: string) => {
    const message = userMessage.toLowerCase();

    if (message.includes('–¥–æ–Ω–∞—Ç') || message.includes('–¥–µ–Ω—å–≥–∏')) {
      return ['–î–æ–Ω–∞—Ç—å, –±—Ä–æ!', '–ì–¥–µ –º–æ–∏ 500‚ÇΩ?', '–î–æ–Ω–∞—Ç—ã –ª–µ—Ç—è—Ç!', '–ü–æ–¥–¥–µ—Ä–∂–∏ –º–µ–Ω—è!'];
    }

    if (message.includes('–∏–≥—Ä–∞') || message.includes('–∫–∞–∑–∏–Ω–æ')) {
      return ['–†—É–ª–µ—Ç–∫–∞ –∂–¥—ë—Ç —Ç–µ–±—è!', '–ö–∞–∑–∏–Ω–æ –æ—Ç–∫—Ä—ã–ª–æ—Å—å!', '–ò–≥—Ä–∞–µ–º –≤ –∏–≥—Ä—ã!', '–ö–∞–∑–∏–Ω–æ –∂–¥—ë—Ç!'];
    }

    if (message.includes('–ø–æ–º–æ—â—å') || message.includes('–ª—é–¥–∏')) {
      return ['–ü–æ–º–æ–≥–∞–µ–º –ª—é–¥—è–º!', '–¢—ã –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—à—å!', '–°–ø–∞—Å–∏–±–æ –∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç!', '–ü—Ä–æ–¥–æ–ª–∂–∞–π!'];
    }

    if (message.includes('—Å—Ç—Ä–∏–º') || message.includes('—ç—Ñ–∏—Ä')) {
      return ['–°—Ç—Ä–∏–º —Ä—É–ª–∏—Ç!', '–ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ—à—ë–ª!', '–≠—Ñ–∏—Ä –∏–¥—ë—Ç!', '–°—Ç—Ä–∏–º –ª–µ–≥–µ–Ω–¥–∞!'];
    }

    if (message.includes('–º–µ–ª—Å—Ç—Ä–æ–π') || message.includes('–º–µ–ª')) {
      return ['–ú–µ–ª—Å—Ç—Ä–æ–π –ª–µ–≥–µ–Ω–¥–∞!', '–¢—ã –ª—É—á—à–∏–π!', '–õ–µ–≥–µ–Ω–¥–∞!', '–¢—ã –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—à—å!'];
    }

    return [
      '–¢—ã –∫—Ç–æ —Ç–∞–∫–æ–π?',
      '–°–ª–∞–±–∞–∫!',
      '–ë–µ—Ä–∏ –º–∞—Å—à—Ç–∞–± ‚Äî –Ω–µ —Ç–æ—Ä–º–æ–∑–∏!',
      '–ü–æ–±–µ–¥–∞!',
      '–õ–µ–≥–µ–Ω–¥–∞!',
      '–¢—ã –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—à—å!',
      '–ü—Ä–æ–¥–æ–ª–∂–∞–π!',
      '–°–ø–∞—Å–∏–±–æ –∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç!',
      '–¢—ã –ª—É—á—à–∏–π!',
      '–ö–∞–∑–∏–Ω–æ –∂–¥—ë—Ç!',
    ];
  };

  // –î–æ–Ω–∞—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
  const startRecentDonations = () => {
    setInterval(() => {
      addRecentDonation();
    }, 5000 + Math.random() * 10000);
  };

  const addRecentDonation = () => {
    const amounts = [500, 1000, 2000, 5000, 10000];
    const currencies = ['‚ÇΩ', '$', '‚Ç¨'];
    const icons = ['üíµ', 'üí∞', 'üíé', 'üí∂', 'ü™ô'];
    const messages = ['–ú–µ–ª, –≤—ã–ø–µ–π –∑–∞ –Ω–∞—Å!', '–ë–µ—Ä–∏ Rolls!', '–ü–æ–º–æ–≥–∏ –ª—é–¥—è–º!', '–¢—ã –ª—É—á—à–∏–π!', '–ö–∞–∑–∏–Ω–æ —Ä—É–ª–∏—Ç!'];
    const usernames = ['user123', 'mell_fan', 'casino_lover', 'stream_viewer', 'donator_pro'];

    const amount = amounts[Math.floor(Math.random() * amounts.length)];
    const currency = currencies[Math.floor(Math.random() * currencies.length)];
    const icon = icons[Math.floor(Math.random() * icons.length)];
    const message = messages[Math.floor(Math.random() * messages.length)];
    const username = usernames[Math.floor(Math.random() * usernames.length)];

    const donation = {
      id: Date.now() + Math.random(),
      amount,
      currency,
      icon,
      message,
      username,
      timestamp: new Date(),
    };

    setRecentDonations((prev) => {
      const newDonations = [donation, ...prev];
      return newDonations.length > 10 ? newDonations.slice(0, 10) : newDonations;
    });
  };

  return {
    // –ß–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
    chatMessages,
    chatInput,
    chatInputMobile,
    chatMessagesRef,
    chatMessagesMobileRef,

    // –ß–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏
    setChatInput,
    setChatInputMobile,
    sendChatMessage,

    // –î–æ–Ω–∞—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è
    recentDonations,
  };
};
